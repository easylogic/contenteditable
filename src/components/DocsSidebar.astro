---
interface Props {
  currentPath?: string;
}

const { currentPath = '' } = Astro.props;

const inputTypePages = [
  { title: 'formatBold', path: '/docs/input-types/formatBold' },
  { title: 'formatItalic', path: '/docs/input-types/formatItalic' },
  { title: 'formatUnderline', path: '/docs/input-types/formatUnderline' },
  { title: 'formatStrikeThrough', path: '/docs/input-types/formatStrikeThrough' },
  { title: 'formatCreateLink', path: '/docs/input-types/formatCreateLink' },
  { title: 'insertText', path: '/docs/input-types/insertText' },
  { title: 'insertCompositionText', path: '/docs/input-types/insertCompositionText' },
  { title: 'insertFromPaste', path: '/docs/input-types/insertFromPaste' },
  { title: 'insertFromDrop', path: '/docs/input-types/insertFromDrop' },
  { title: 'insertFromYank', path: '/docs/input-types/insertFromYank' },
  { title: 'insertReplacementText', path: '/docs/input-types/insertReplacementText' },
  { title: 'insertFromPredictiveText', path: '/docs/input-types/insertFromPredictiveText' },
  { title: 'insertParagraph', path: '/docs/input-types/insertParagraph' },
  { title: 'insertLineBreak', path: '/docs/input-types/insertLineBreak' },
  { title: 'insertOrderedList', path: '/docs/input-types/insertOrderedList' },
  { title: 'insertUnorderedList', path: '/docs/input-types/insertUnorderedList' },
  { title: 'insertHTML', path: '/docs/input-types/insertHTML' },
  { title: 'deleteContent', path: '/docs/input-types/deleteContent' },
  { title: 'deleteContentForward', path: '/docs/input-types/deleteContentForward' },
  { title: 'deleteContentBackward', path: '/docs/input-types/deleteContentBackward' },
  { title: 'deleteWordBackward', path: '/docs/input-types/deleteWordBackward' },
  { title: 'deleteWordForward', path: '/docs/input-types/deleteWordForward' },
  { title: 'deleteByCut', path: '/docs/input-types/deleteByCut' },
  { title: 'deleteByDrag', path: '/docs/input-types/deleteByDrag' },
  { title: 'deleteByComposition', path: '/docs/input-types/deleteByComposition' },
  { title: 'formatRemove', path: '/docs/input-types/formatRemove' },
  { title: 'formatJustifyFull', path: '/docs/input-types/formatJustifyFull' },
  { title: 'formatJustifyCenter', path: '/docs/input-types/formatJustifyCenter' },
  { title: 'formatJustifyRight', path: '/docs/input-types/formatJustifyRight' },
  { title: 'formatJustifyLeft', path: '/docs/input-types/formatJustifyLeft' },
  { title: 'formatIndent', path: '/docs/input-types/formatIndent' },
  { title: 'formatOutdent', path: '/docs/input-types/formatOutdent' },
  { title: 'insertHorizontalRule', path: '/docs/input-types/insertHorizontalRule' },
  { title: 'historyUndo', path: '/docs/input-types/historyUndo' },
  { title: 'historyRedo', path: '/docs/input-types/historyRedo' },
];

const docsPages = [
  { title: 'What is contenteditable?', path: '/docs/what-is-contenteditable' },
  { title: 'Events', path: '/docs/events' },
  { title: 'IME & Composition', path: '/docs/ime-composition' },
  { title: 'Selection API', path: '/docs/selection-api' },
  { title: 'Range API', path: '/docs/range-api' },
  { title: 'Clipboard API', path: '/docs/clipboard-api' },
  { title: 'Mobile Selection Toolbar', path: '/docs/mobile-selection-toolbar' },
  { title: 'execCommand alternatives', path: '/docs/execCommand-alternatives' },
  { title: 'Practical Patterns', path: '/docs/practical-patterns' },
  { title: 'Common Pitfalls & Debugging', path: '/docs/common-pitfalls' },
  { title: 'Performance', path: '/docs/performance' },
  { title: 'Accessibility', path: '/docs/accessibility' },
  { title: 'Keyboard Navigation', path: '/docs/keyboard-navigation' },
  { title: 'contenteditable="false"', path: '/docs/contenteditable-false' },
  { title: 'HTML Attributes', path: '/docs/html-attributes' },
  { title: 'Shadow DOM & Web Components', path: '/docs/shadow-dom-web-components' },
  { title: 'Drag & Drop', path: '/docs/drag-and-drop' },
  { title: 'Focus & Blur Events', path: '/docs/focus-blur-events' },
  { title: 'iframe Integration', path: '/docs/iframe-integration' },
  { title: 'CSS & Styling', path: '/docs/css-styling' },
  { title: 'Browser Detection', path: '/docs/browser-detection' },
  { title: 'Browser compatibility', path: '/docs/browser-compatibility' },
  { 
    title: 'Input Types', 
    path: '/docs/input-types',
    children: inputTypePages
  },
];

const isInputTypesSection = currentPath.startsWith('/docs/input-types');
const isInputTypesRoot = currentPath === '/docs/input-types';
---

<aside
  aria-label="Documentation"
  class="docs-sidebar"
>
  <div class="docs-sidebar-header">
    <div class="docs-sidebar-title">
      <span class="font-semibold text-sm">Documentation</span>
      <a href="/docs" class="docs-index-link">Index â†’</a>
    </div>
  </div>

  <nav aria-label="Documentation pages" class="py-2">
    <ul class="list-none p-0 m-0">
      {docsPages.map((doc) => {
        const isActive = currentPath === doc.path;
        const hasChildren = doc.children && doc.children.length > 0;
        const isParentActive = hasChildren && isInputTypesSection;
        
        return (
          <li class="m-0">
            <a
              href={doc.path}
              title={doc.title}
              class={`docs-nav-link ${isActive || (hasChildren && isInputTypesRoot) ? 'active' : ''}`}
            >
              {doc.title}
            </a>
            {hasChildren && (
              <ul class={`list-none p-0 m-0 pl-4 ${isParentActive ? 'docs-subnav-expanded' : ''}`}>
                {doc.children.map((child) => {
                  const isChildActive = currentPath === child.path;
                  return (
                    <li class="m-0">
                      <a
                        href={child.path}
                        title={child.title}
                        class={`docs-nav-link docs-subnav-link ${isChildActive ? 'active' : ''}`}
                      >
                        {child.title}
                      </a>
                    </li>
                  );
                })}
              </ul>
            )}
          </li>
        );
      })}
    </ul>
  </nav>
</aside>

<style>
  .docs-sidebar {
    position: sticky;
    top: 0;
    height: 100vh;
    overflow-y: auto;
    width: 240px;
    min-width: 240px;
    border-right: 1px solid var(--border-light);
    background: var(--bg-muted);
    padding: 0;
    font-size: 0.875rem;
    flex-shrink: 0;
  }

  .docs-sidebar-header {
    padding: 1rem 0.75rem;
    border-bottom: 1px solid var(--border-light);
    background: var(--bg-surface);
  }

  .docs-sidebar-title {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
  }

  .docs-index-link {
    font-size: 0.75rem;
    color: var(--accent-primary);
    text-decoration: none;
  }

  .docs-nav-link {
    display: block;
    padding: 0.4rem 0.75rem;
    text-decoration: none;
    font-size: 0.875rem;
    background-color: transparent;
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    border-left: 3px solid transparent;
    transition: background-color 0.15s, color 0.15s;
  }

  .docs-nav-link:hover {
    background-color: var(--bg-muted);
  }

  .docs-nav-link.active {
    background-color: var(--accent-primary);
    color: white;
    border-left-color: var(--accent-primary);
  }

  .docs-subnav-link {
    font-size: 0.8rem;
    padding: 0.3rem 0.75rem;
    color: var(--text-secondary);
    border-left: 2px solid transparent;
  }

  .docs-subnav-link:hover {
    background-color: var(--bg-surface);
    color: var(--text-primary);
  }

  .docs-subnav-link.active {
    background-color: var(--bg-surface);
    color: var(--accent-primary);
    border-left-color: var(--accent-primary);
    font-weight: 500;
  }

  .docs-subnav-expanded {
    display: block;
  }
</style>

